<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NxtTurn • Profile</title>
  <link href="dist/output.css" rel="stylesheet">

  <style>



    .nt-scroll::-webkit-scrollbar{width:10px;height:10px}
    .nt-scroll::-webkit-scrollbar-thumb{background:#e5e7eb;border-radius:999px}
    .nt-scroll:hover::-webkit-scrollbar-thumb{background:#cbd5e1}
    .toast-enter{opacity:0;transform:translateY(6px)}
    .toast-enter-active{opacity:1;transform:translateY(0);transition:all .18s ease-out}
    .toast-leave{opacity:1}
    .toast-leave-active{opacity:0;transition:opacity .15s ease-in}

    .col-scroll{height:calc(100vh - 24px); overflow-y:auto; overscroll-behavior:contain;}
    .col-left{scrollbar-width:none;}
    .col-left::-webkit-scrollbar{width:0;height:0}

    #feed{min-height:0;}

    /* galleries */
    .mosaicWrap{background:#fff;border-radius:.5rem;overflow:hidden;margin-top:.75rem}
    .mosaic{display:grid;gap:1px}
    .mosaic.two{grid-template-columns:1fr 1fr;height:320px}
    .mosaic.three{grid-template-columns:1fr 1fr;grid-template-rows:1fr 1fr;height:420px}
    .mosaic.four{grid-template-columns:1fr 1fr;grid-template-rows:1fr 1fr;height:420px}
    .mosaic-tile{position:relative;overflow:hidden;background:#000}
    .mosaic-tile>img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}

    /* reactions */
    .rx-holder{position:relative;display:inline-block;vertical-align:middle;}
    .btn-like{white-space:nowrap;position:relative;top:1px;}
    .rx-tray{
      position:absolute; bottom:calc(100% + 8px); left:0; z-index:30;
      display:flex; gap:.35rem; padding:.35rem .45rem; border-radius:999px;
      background:rgba(255,255,255,.75); border:1px solid rgba(148,163,184,.35);
      box-shadow:0 14px 36px rgba(15,23,42,.20);
      backdrop-filter:saturate(160%) blur(10px);
      transform-origin:bottom left; opacity:0; transform:translateY(6px) scale(.96);
      pointer-events:none; transition:opacity .16s ease, transform .16s ease;
    }
    .rx-tray.hidden{display:none !important}
    .rx-tray.show{opacity:1;transform:translateY(0) scale(1);pointer-events:auto}

    .rx-emoji{
      position:relative;width:42px;height:42px;border-radius:999px;
      display:grid;place-items:center;font-size:20px;line-height:1;
      background:linear-gradient(#ffffff,#f8fafc); border:1px solid rgba(148,163,184,.35);
      box-shadow:0 2px 6px rgba(15,23,42,.08);
      transform:translateY(0) scale(1);
      transition:transform .12s ease, box-shadow .12s ease;
      cursor:pointer; user-select:none;
    }
    .rx-emoji:hover{transform:translateY(-2px) scale(1.08);box-shadow:0 10px 20px rgba(15,23,42,.12)}
    .rx-emoji:active{transform:scale(.95)}
    .rx-emoji[aria-selected="true"]{
      box-shadow:0 0 0 2px #3b82f6 inset, 0 6px 18px rgba(59,130,246,.22);
      background:linear-gradient(#eaf2ff,#ffffff);
    }
    .rx-emoji::after{
      content:attr(data-label);
      position:absolute;bottom:-26px;left:50%;transform:translateX(-50%) translateY(6px);
      font-size:11px;background:#0f172a;color:#fff;padding:2px 6px;border-radius:999px;
      opacity:0;pointer-events:none;white-space:nowrap;
      transition:opacity .12s ease, transform .12s ease;
    }
    .rx-emoji:hover::after{opacity:1;transform:translateX(-50%) translateY(0)}

    @keyframes rxPop{0%{transform:scale(.8);opacity:.2}60%{transform:scale(1.15);opacity:1}100%{transform:scale(1)}

    }

    /* polish for cards/meters */
    #content-skill .p-3{transition: box-shadow .18s ease, transform .12s ease, border-color .18s ease;}
    #content-skill .p-3:hover{transform: translateY(-1px); box-shadow: 0 8px 22px rgba(15,23,42,.08); border-color: rgba(148,163,184,.35);}
    .skill-meter{height:.45rem;border-radius:999px;overflow:hidden;background: linear-gradient(180deg,#eef2f7,#e9eef6)}
    .skill-meter > span{display:block;height:100%;transition:width .35s ease;background: linear-gradient(90deg,#60a5fa,#3b82f6,#2563eb); position:relative; overflow:hidden}
    .skill-meter > span::after{content:"";position:absolute;inset:0 0 0 auto;width:30%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.35),transparent);transform:translateX(-120%);animation:sweep 2.4s ease-in-out infinite;pointer-events:none}
    @keyframes sweep{0%{transform:translateX(-120%)}60%{transform:translateX(120%)}100%{transform:translateX(120%)}}

    .badge-verified{display:inline-flex;align-items:center;gap:.25rem;padding:.18rem .45rem;border-radius:999px;font-size:.7rem;background:linear-gradient(#f0f7ff,#ffffff);border:1px solid rgba(148,163,184,.35)}

    /* ===== Bigger, responsive Skills editor ===== */
    .modal-panel{width:100%;max-width:80rem}          /* was ~max-w-2xl; now 1280px */
    .editor-scroll{max-height:65vh;overflow:auto}
    .editor-head{position:sticky;top:0;background:#fff;z-index:10;border-bottom:1px solid rgba(148,163,184,.35)}
    .editor-grid{display:grid;grid-template-columns:4fr 1.5fr 1.5fr 1.6fr 1.2fr 1fr;gap:.75rem}
    .editor-row{display:grid;grid-template-columns:4fr 1.5fr 1.5fr 1.6fr 1.2fr 1fr;gap:.75rem;align-items:center}
    .editor-row>*{min-width:0}                         /* prevent overflow */
    .editor-row input,.editor-row select{width:100%}   /* full width controls */

    @media (max-width:1024px){
      .editor-grid,.editor-row{grid-template-columns:1fr 1fr}
    }
    @media (max-width:640px){
      .editor-grid,.editor-row{grid-template-columns:1fr}
      .editor-head{display:none}
    }
  </style>
</head>ya lokanni khub disturb kela aaj
<body class="bg-slate-50 text-slate-800">

  <main class="max-w-7xl mx-auto px-3 sm:px-6 py-3 grid grid-cols-1 lg:grid-cols-12 gap-5">
    <!-- LEFT: PROFILE -->
    <aside class="lg:col-span-6 xl:col-span-6 col-scroll col-left pr-1" id="profile">
      <section class="bg-white rounded-2xl shadow border border-slate-100 overflow-visible">
        <div class="relative h-44 cursor-pointer" onclick="openViewer([state.cover],0)">
          <img id="coverImg" src="https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?auto=format&fit=crop&w=1200&q=80" class="w-full h-full object-cover rounded-t-2xl" alt="cover">
          <div class="absolute top-3 right-3 z-50">
            <button id="coverMenuBtn" class="p-2 rounded-full bg-white shadow hover:bg-slate-50" aria-label="menu">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5"><path d="M12 6.75a1.5 1.5 0 110-3 1.5 1.5 0 010 3zM12 13.5a1.5 1.5 0 110-3 1.5 1.5 0 010 3zM12 20.25a1.5 1.5 0 110-3 1.5 1.5 0 010 3z"/></svg>
            </button>
            <div id="coverMenu" class="hidden absolute right-0 mt-2 w-56 bg-white rounded-xl shadow-lg border border-slate-100 overflow-hidden z-50">
              <button class="w-full text-left px-4 py-2 hover:bg-slate-50" onclick="openEdit('cover')">Edit Cover</button>
              <button class="w-full text-left px-4 py-2 hover:bg-slate-50" onclick="openEdit('avatar')">Edit Profile Photo</button>
              <button class="w-full text-left px-4 py-2 hover:bg-slate-50" onclick="openEdit('nameUser')">Edit Name</button>
            </div>
          </div>
        </div>

        <div class="px-5 pb-5 -mt-10">
          <div class="flex flex-col items-center text-center relative">
            <div class="relative cursor-pointer" onclick="openViewer([state.avatar],0)">
              <img id="avatarImg" src="https://i.pravatar.cc/160?img=5" class="h-28 w-28 rounded-full ring-4 ring-white object-cover" alt="profile">
              <button class="absolute bottom-1 right-1 p-2 rounded-full bg-blue-600 text-white shadow hover:bg-blue-700" onclick="event.stopPropagation(); openEdit('avatar')" aria-label="edit avatar">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4"><path d="M21.731 2.269a2.625 2.625 0 00-3.713 0l-1.157 1.157 3.713 3.713 1.157-1.157a2.625 2.625 0 000-3.713z"/><path d="M3.75 15.75V21h5.25l9.284-9.284-3.713-3.713L3.75 15.75z"/></svg>
              </button>
            </div>
            <div class="mt-3 flex items-center gap-2">
              <h2 id="profileName" class="text-xl font-bold">Sakshi</h2>
              <p id="profileUser" class="text-slate-500">@Sakshi</p>
              <button onclick="openEdit('nameUser')" class="p-2 rounded-full hover:bg-slate-100" title="Edit name & username">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4"><path d="M21.731 2.269a2.625 2.625 0 00-3.713 0l-1.157 1.157 3.713 3.713 1.157-1.157a2.625 2.625 0 000-3.713z"/><path d="M3.75 15.75V21h5.25l9.284-9.284-3.713-3.713L3.75 15.75z"/></svg>
              </button>
            </div>
          </div>

          <div class="mt-5 grid grid-cols-2 gap-3 text-sm">
            <button class="rounded-xl border border-slate-200 p-3 bg-slate-50 text-left">
              <div class="text-slate-500">Followers</div>
              <div class="font-semibold">1,248</div>
            </button>
            <button class="rounded-xl border border-slate-200 p-3 bg-slate-50 text-left">
              <div class="text-slate-500">Following</div>
              <div class="font-semibold">321</div>
            </button>
          </div>

          <div class="mt-5">
            <div class="grid grid-cols-5 gap-2 text-sm font-medium">
              <button id="tab-bio" class="py-2 rounded-lg border border-slate-200 hover:bg-slate-50" onclick="toggleTab('bio')">Bio</button>
              <button id="tab-edu" class="py-2 rounded-lg border border-slate-200 hover:bg-slate-50" onclick="toggleTab('edu')">Education</button>
              <button id="tab-skill" class="py-2 rounded-lg border border-slate-200 hover:bg-slate-50" onclick="toggleTab('skill')">Skills</button>
              <button id="tab-exp" class="py-2 rounded-lg border border-slate-200 hover:bg-slate-50" onclick="toggleTab('exp')">Experience</button>
              <button id="tab-contact" class="py-2 rounded-lg border border-slate-200 hover:bg-slate-50" onclick="toggleTab('contact')">Contact</button>
            </div>

            <div id="tabContent" class="mt-3 hidden">
              <div class="flex items-center justify-between mb-2">
                <div class="text-sm text-slate-600" id="sectionLabel"></div>
                <div class="flex items-center gap-3">
                  <button id="btnAdd" class="p-2 rounded-full hover:bg-slate-100" title="Add">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5"><path d="M12 4.5a1 1 0 011 1V11h5.5a1 1 0 110 2H13v5.5a1 1 0 11-2 0V13H5.5a1 1 0 110-2H11V5.5a1 1 0 011-1z"/></svg>
                  </button>
                  <button id="btnEdit" class="p-2 rounded-full hover:bg-slate-100" title="Edit">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M21.731 2.269a2.625 2.625 0 00-3.713 0l-1.157 1.157 3.713 3.713 1.157-1.157a2.625 2.625 0 000-3.713z"/><path d="M3.75 15.75V21h5.25l9.284-9.284-3.713-3.713L3.75 15.75z"/></svg>
                  </button>
                  <button id="btnDelete" class="p-2 rounded-full hover:bg-red-50 text-red-600" title="Delete">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M9 3a1 1 0 00-1 1v1H5.5a1 1 0 100 2H6v12a2 2 0 002 2h8a2 2 0 002-2V7h.5a1 1 0 100-2H16V4a1 1 0 00-1-1H9zm2 3V4h4v2h-4zM9 9a1 1 0 012 0v8a1 1 0 11-2 0V9zm6 0a1 1 0 10-2 0v8a1 1 0 102 0V9z"/></svg>
                  </button>
                </div>
              </div>

              <div id="content-bio" class="hidden space-y-2"></div>
              <div id="content-edu" class="hidden space-y-2"></div>
              <div id="content-skill" class="hidden space-y-2"></div>
              <div id="content-exp" class="hidden space-y-2"></div>
              <div id="content-contact" class="hidden space-y-2"></div>
            </div>
          </div>
        </div>
      </section>
    </aside>

    <!-- RIGHT: FEED -->
    <section class="lg:col-span-6 xl:col-span-6 col-scroll pl-1">
      <div id="feed" class="space-y-4 pb-24"></div>
    </section>
  </main>

  <!-- LIGHTBOX -->
  <div id="viewer" class="hidden fixed inset-0 z-50 bg-black/90 flex items-center justify-center">
    <button id="viewerPrev" class="absolute left-4 md:left-6 top-1/2 -translate-y-1/2 text-white/80 hover:text-white text-3xl">‹</button>
    <button id="viewerNext" class="absolute right-4 md:right-6 top-1/2 -translate-y-1/2 text-white/80 hover:text-white text-3xl">›</button>
    <button id="viewerClose" class="absolute top-5 right-5 text-white text-3xl">✕</button>
    <div class="flex flex-col items-center gap-3">
      <img id="viewerImg" class="max-h-[82vh] max-w-[92vw] rounded-lg shadow-2xl select-none" draggable="false" />
      <div class="flex gap-2">
        <button class="px-3 py-1.5 rounded bg-white/10 text-white hover:bg-white/20" id="zoomOut">-</button>
        <button class="px-3 py-1.5 rounded bg-white/10 text-white hover:bg-white/20" id="zoomReset">100%</button>
        <button class="px-3 py-1.5 rounded bg-white/10 text-white hover:bg-white/20" id="zoomIn">+</button>
      </div>
    </div>
  </div>

  <!-- EDIT MODAL -->
  <div id="editModal" class="hidden fixed inset-0 z-50 bg-black/40 grid place-items-center p-4">
    <div class="modal-panel bg-white rounded-2xl shadow-xl overflow-hidden">
      <div class="flex items-center justify-between p-4 border-b">
        <h3 id="editTitle" class="text-lg font-semibold">Edit</h3>
        <button class="p-2 rounded-lg hover:bg-slate-100" onclick="closeEdit()">✕</button>
      </div>
      <div class="p-4 space-y-3 editor-scroll">
        <div id="editSlot"></div>
        <div class="flex justify-end gap-2 pt-2">
          <button class="px-4 py-2 rounded-xl border border-slate-200 hover:bg-slate-50" onclick="closeEdit()">Cancel</button>
          <button id="editSaveBtn" class="px-4 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-700">Save</button>
        </div>
      </div>
    </div>
  </div>

  <!-- TOASTS -->
  <div id="toasts" class="fixed bottom-5 left-1/2 -translate-x-1/2 z-[60] space-y-2"></div>

  <script>

    /* Adjustable feed size */
    const FEED_SIZE = 50;

    const coverMenuBtn=document.getElementById('coverMenuBtn');
    const coverMenu=document.getElementById('coverMenu');
    coverMenuBtn.addEventListener('click',e=>{e.stopPropagation(); coverMenu.classList.toggle('hidden')});
    document.addEventListener('click',()=>coverMenu.classList.add('hidden'));

    function toast(msg){
      const host=document.getElementById('toasts');
      const el=document.createElement('div');
      el.className='toast-enter bg-black/80 text-white px-3 py-2 rounded-lg text-sm shadow';
      el.textContent=msg; host.appendChild(el);
      requestAnimationFrame(()=>{ el.classList.add('toast-enter-active'); });
      setTimeout(()=>{ el.classList.remove('toast-enter-active'); el.classList.add('toast-leave','toast-leave-active'); setTimeout(()=>el.remove(),180); },1600);
    }

    /* viewer */
    const viewer=document.getElementById('viewer');
    const viewerImg=document.getElementById('viewerImg');
    const viewerPrev=document.getElementById('viewerPrev');
    const viewerNext=document.getElementById('viewerNext');
    const viewerClose=document.getElementById('viewerClose');
    const zoomIn=document.getElementById('zoomIn');
    const zoomOut=document.getElementById('zoomOut');
    const zoomReset=document.getElementById('zoomReset');
    let viewerImages=[], viewerIndex=0, zoom=1;
    function openViewer(images, index=0){ viewerImages=images; viewerIndex=index; zoom=1; viewerImg.style.transform='scale(1)'; viewerImg.src=viewerImages[viewerIndex]; viewer.classList.remove('hidden'); document.body.classList.add('overflow-hidden'); }
    function closeViewer(){ viewer.classList.add('hidden'); document.body.classList.remove('overflow-hidden'); }
    function navViewer(dir){ viewerIndex=(viewerIndex+dir+viewerImages.length)%viewerImages.length; viewerImg.src=viewerImages[viewerIndex]; zoom=1; viewerImg.style.transform='scale(1)'; }
    viewerPrev.onclick=()=>navViewer(-1); viewerNext.onclick=()=>navViewer(1); viewerClose.onclick=closeViewer;
    zoomIn.onclick=()=>{ zoom=Math.min(zoom+0.2,3); viewerImg.style.transform=`scale(${zoom})`; };
    zoomOut.onclick=()=>{ zoom=Math.max(zoom-0.2,0.5); viewerImg.style.transform=`scale(${zoom})`; };
    zoomReset.onclick=()=>{ zoom=1; viewerImg.style.transform='scale(1)'; };
    window.addEventListener('keydown',e=>{ if(viewer.classList.contains('hidden')) return; if(e.key==='Escape') closeViewer(); if(e.key==='ArrowRight') navViewer(1); if(e.key==='ArrowLeft') navViewer(-1); });

    /* ========= STATE ========= */
    const state={
      name:'Sakshi',
      username:'@Sakshi',
      avatar:'https://i.pravatar.cc/160?img=5',
      cover:'https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?auto=format&fit=crop&w=1200&q=80',
      bio:['Design-leaning UI engineer passionate about delightful interactions.'],
      experience:[
        'UI Engineer @ WebArtifacts (2024–Present)',
        'Designer @ SD Engineering (2022–2024)'
      ],
      education:['B.Tech – Computer Science, RTMNU'],
      /* skills stored as months */
      skills:['Tailwind','React','Node','UI Prototyping'],
      contact:['Email: sakshi@example.com','Phone: +91-90000-00000'],
      posts:[]
    };

    function escapeHTML(s){ return (s||'').replace(/[&<>"']/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[m])); }
    function countComments(p){ let n=0; (p.comments||[]).forEach(c=>{ n++; if(c.replies) n+=c.replies.length; }); return n; }

    const sectionLabel=document.getElementById('sectionLabel');
    const btnAdd=document.getElementById('btnAdd');
    const btnEdit=document.getElementById('btnEdit');
    const btnDelete=document.getElementById('btnDelete');
    let currentTab=null, deleteModeKey=null;

    function resetTabs(){
      ['bio','edu','skill','exp','contact'].forEach(k=>{
        const t=document.getElementById('tab-'+k);
        t && t.classList.remove('text-blue-600','border-blue-300','bg-blue-50');
        const el=document.getElementById('content-'+k); if(el) el.classList.add('hidden');
      });
      document.getElementById('tabContent').classList.add('hidden');
      currentTab=null; deleteModeKey=null;
    }
    function toggleTab(k){
      const tab=document.getElementById('tab-'+k);
      const content=document.getElementById('content-'+k);
      const isOpen=!content.classList.contains('hidden');
      resetTabs();
      if(!isOpen){
        tab.classList.add('text-blue-600','border-blue-300','bg-blue-50');
        document.getElementById('tabContent').classList.remove('hidden');
        content.classList.remove('hidden');
        currentTab=k;
        sectionLabel.textContent=({bio:'Bio',edu:'Education',skill:'Skills',exp:'Experience',contact:'Contact'})[k]||'';
      }
      render();
    }

    function deleteItem(key, idx){ const arr=state[key]; if(!Array.isArray(arr)) return; arr.splice(idx,1); render(); toast('Deleted'); }

    const feedEl=document.getElementById('feed');
    let editing = { type:null, pid:null, cid:null, rid:null };

    /* icons for skills */
    function skillIcon(name){
      const n=(name||'').toLowerCase();
      const wrap=(svg,bg='bg-slate-100')=>`<span class="inline-flex items-center justify-center h-7 w-7 rounded-xl ${bg} ring-1 ring-slate-200/70 mr-2">${svg}</span>`;
      if(n.includes('react')) return wrap(`<svg viewBox="0 0 24 24" class="w-4 h-4 text-cyan-600" fill="none" stroke="currentColor" stroke-width="1.4"><circle cx="12" cy="12" r="1.8" fill="currentColor"></circle><ellipse cx="12" cy="12" rx="9" ry="3.5"></ellipse><ellipse cx="12" cy="12" rx="9" ry="3.5" transform="rotate(60 12 12)"></ellipse><ellipse cx="12" cy="12" rx="9" ry="3.5" transform="rotate(-60 12 12)"></ellipse></svg>`, 'bg-cyan-50');
      if(n.includes('tailwind')) return wrap(`<svg viewBox="0 0 24 24" class="w-5 h-5 text-sky-500" fill="currentColor"><path d="M3 10c2-4 6-5 9-2 3 3 5 2 9 0-2 4-6 5-9 2-3-3-5-2-9 0z"></path><path d="M3 16c2-4 6-5 9-2 3 3 5 2 9 0-2 4-6 5-9 2-3-3-5-2-9 0z" opacity=".9"></path></svg>`, 'bg-sky-50');
      if(n.includes('node')) return wrap(`<svg viewBox="0 0 24 24" class="w-5 h-5 text-emerald-600" fill="currentColor"><path d="M12 2l8 4.6v10.8L12 22l-8-4.6V6.6L12 2z"></path><path d="M9 15V9l6 6V9" fill="none" stroke="white" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path></svg>`, 'bg-emerald-50');
      const svgDefault=`<svg viewBox="0 0 24 24" class="w-4 h-4 text-slate-600" fill="currentColor"><path d="M12 3l2.6 5.3L20 9.2l-4 3.9.9 5.8L12 16.8 7.1 19l.9-5.8-4-3.9 5.4-1z"></path></svg>`;
      return wrap(svgDefault);
    }

    /* -------- Reactions ---------- */
    function reactionButtonHTML(p){
      const REACTIONS = {
        like:       { label:'Like',       icon:'👍' },
        love:       { label:'Love',       icon:'❤️' },
        celebrate:  { label:'Celebrate',  icon:'🎉' },
        insightful: { label:'Insightful', icon:'💡' },
        support:    { label:'Support',    icon:'👏' },
      };
      const heartOutlineSVG =
        `<svg class="w-5 h-5" viewBox="0 0 24 24" fill="none">
           <path d="M21 10.5c0 2.6-1.69 4.86-3.99 7A25.3 25.3 0 0112 20.5a25.3 25.3 0 01-5.01-3c-2.3-2.14-3.99-4.4-3.99-7A4.5 4.5 0 017.5 6c1.53 0 2.87.72 3.75 1.84A4.66 4.66 0 0115.5 6 4.5 4.5 0 0121 10.5z"
             stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>`;

      const rx = p.reaction;
      const icon = rx ? `<span class="text-lg leading-none">${REACTIONS[rx].icon}</span>` : heartOutlineSVG;
      const label = rx ? REACTIONS[rx].label : 'Like';

      return `
        <div class="rx-holder">
          <button class="btn-like inline-flex items-center gap-1 text-slate-600 hover:text-slate-800" data-id="${p.id}">
            ${icon}<span class="font-medium">${label}</span><span class="ml-1 text-slate-500">${p.likes||0}</span>
          </button>
          <div class="rx-tray hidden">
            ${Object.entries(REACTIONS).map(([k,v]) =>
              `<button class="rx-emoji" data-rx="${k}" data-label="${v.label}" aria-selected="${p.reaction===k}">${v.icon}</button>`
            ).join('')}
          </div>
        </div>`;
    }

    function closeAllTrays(){
      document.querySelectorAll('.rx-tray').forEach(t=>{
        t.classList.remove('show'); t.classList.add('hidden');
      });
    }
    if(!window.__rxScrollBound){ window.addEventListener('scroll', closeAllTrays, true); window.__rxScrollBound=true; }

    function wireReactions(wrap, p){
      const holder = wrap.querySelector('.rx-holder');
      const tray   = holder.querySelector('.rx-tray');
      const likeBtn= holder.querySelector('.btn-like');
      let hideTimer=null;

      function openTray(){ closeAllTrays(); tray.classList.remove('hidden'); requestAnimationFrame(()=> tray.classList.add('show')); }
      function closeTrayNow(){ tray.classList.remove('show'); setTimeout(()=> tray.classList.add('hidden'), 160); }
      function scheduleHide(){ clearTimeout(hideTimer); hideTimer=setTimeout(closeTrayNow, 220); }

      likeBtn.addEventListener('mouseenter', openTray);
      tray.addEventListener('mouseenter', ()=>clearTimeout(hideTimer));
      holder.addEventListener('mouseleave', scheduleHide);
      holder.addEventListener('click', e => e.stopPropagation());
      document.addEventListener('click', closeAllTrays);

      likeBtn.addEventListener('click', (e)=>{
        e.stopPropagation();
        if(p.reaction==='like'){ p.reaction=null; p.likes=Math.max(0,(p.likes||0)-1); }
        else { if(!p.reaction) p.likes=(p.likes||0)+1; p.reaction='like'; }
        render();
      });

      tray.querySelectorAll('[data-rx]').forEach(b=>{
        b.addEventListener('click',(e)=>{
          e.stopPropagation();
          b.classList.add('burst'); b.addEventListener('animationend',()=>b.classList.remove('burst'),{once:true});
          const rx=b.dataset.rx;
          if(p.reaction===rx){ p.reaction=null; p.likes=Math.max(0,(p.likes||0)-1); }
          else { if(!p.reaction) p.likes=(p.likes||0)+1; p.reaction=rx; }
          closeTrayNow(); render();
        });
      });
    }

    function galleryHTML(imgs){
      const n = imgs.length;
      const escList = JSON.stringify(imgs);
      const dataAttr = `data-images='${escList}'`;
      if(n <= 1){
        const src = imgs[0];
        return `<img loading="lazy" src="${src}" class="mt-3 rounded-lg w-full object-cover max-h-96 cursor-pointer" ${dataAttr} onclick="openViewer(JSON.parse(this.dataset.images), 0)">`;
      }
      if(n === 2){
        return `<div class="mosaicWrap"><div class="mosaic two">
          ${imgs.map((src,i)=>`<div class="mosaic-tile cursor-pointer" ${dataAttr} onclick="openViewer(JSON.parse(this.dataset.images), ${i})"><img loading="lazy" src="${src}"></div>`).join('')}
        </div></div>`;
      }
      if(n === 3){
        return `<div class="mosaicWrap"><div class="mosaic three">
          <div class="mosaic-tile cursor-pointer" style="grid-row:1 / span 2" ${dataAttr} onclick="openViewer(JSON.parse(this.dataset.images), 0)"><img loading="lazy" src="${imgs[0]}"></div>
          <div class="mosaic-tile cursor-pointer" ${dataAttr} onclick="openViewer(JSON.parse(this.dataset.images), 1)"><img loading="lazy" src="${imgs[1]}"></div>
          <div class="mosaic-tile cursor-pointer" ${dataAttr} onclick="openViewer(JSON.parse(this.dataset.images), 2)"><img loading="lazy" src="${imgs[2]}"></div>
        </div></div>`;
      }
      if(n === 4){
        return `<div class="mosaicWrap"><div class="mosaic four">
          ${imgs.slice(0,4).map((src,i)=>`<div class="mosaic-tile cursor-pointer" ${dataAttr} onclick="openViewer(JSON.parse(this.dataset.images), ${i})"><img loading="lazy" src="${src}"></div>`).join('')}
        </div></div>`;
      }
      const remain = n - 3;
      return `<div class="mosaicWrap"><div class="mosaic three">
        <div class="mosaic-tile cursor-pointer" style="grid-row:1 / span 2" ${dataAttr} onclick="openViewer(JSON.parse(this.dataset.images), 0)"><img loading="lazy" src="${imgs[0]}"></div>
        <div class="mosaic-tile cursor-pointer" ${dataAttr} onclick="openViewer(JSON.parse(this.dataset.images), 1)"><img loading="lazy" src="${imgs[1]}"></div>
        <div class="mosaic-tile cursor-pointer" ${dataAttr} onclick="openViewer(JSON.parse(this.dataset.images), 2)"><img loading="lazy" src="${imgs[2]}"><div class="absolute inset-0 bg-black/40 text-white text-2xl font-semibold grid place-items-center select-none">+${remain}</div></div>
      </div></div>`;
    }

    function renderPost(p){
      const wrap=document.createElement('article');
      wrap.className='bg-white rounded-xl shadow border border-slate-100 p-4';
      let media='';
      if(p.type==='text'){
        media = `<div class="mt-3 whitespace-pre-wrap max-h-48 overflow-y-auto p-2 bg-slate-50 rounded-lg">${escapeHTML(p.text||'')}</div>`;
      }else if(p.type==='image'){
        media = `<img loading="lazy" src="${p.src}" class="mt-3 rounded-lg w-full object-cover max-h-96 cursor-pointer" onclick="openViewer(['${p.src}'],0)">`;
      }else if(p.type==='video'){
        media = `<video class="mt-3 rounded-lg w-full max-h-96" controls src="${p.src}"></video>`;
      }else if(p.type==='gallery'){
        media = galleryHTML(p.images||[]);
      }

      const cmCount=countComments(p);
      wrap.innerHTML = `
        <div class="flex items-start gap-3">
          <img src="${p.avatar}" class="h-9 w-9 rounded-full">
          <div class="flex-1">
            <div class="font-semibold">${p.author}</div>
            <div class="text-xs text-slate-500">about ${p.time} ago</div>
            ${p.caption ? `<div class="mt-1 text-[15px] text-slate-800">${escapeHTML(p.caption)}</div>` : ''}
          </div>
          <div class="relative z-30">
            <button class="p-2 rounded-full hover:bg-slate-100" aria-label="post menu">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5"><path d="M12 6.75a1.5 1.5 0 110-3 1.5 1.5 0 010 3zM12 13.5a1.5 1.5 0 110-3 1.5 1.5 0 010 3zM12 20.25a1.5 1.5 0 110-3 1.5 1.5 0 010 3z"/></svg>
            </button>
            <div class="hidden absolute right-0 mt-2 w-44 bg-white rounded-xl shadow-lg border border-slate-100 overflow-hidden z-40">
              <button class="w-full text-left px-4 py-2 hover:bg-slate-50" onclick="openEdit('postCaption',{pid:'${p.id}'})">Edit caption</button>
              <button class="w-full text-left px-4 py-2 text-red-600 hover:bg-red-50" onclick="deletePost('${p.id}')">Delete Post</button>
            </div>
          </div>
        </div>
        ${media}
        <div class="mt-3 h-px bg-slate-200 w-full"></div>
        <div class="pt-3 flex items-center justify-between">
          <div class="flex items-center gap-6">
            ${reactionButtonHTML(p)}
            <button class="inline-flex items-center gap-1 text-slate-600 hover:text-slate-800" onclick="toggleComments('${p.id}')">
              <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none"><path d="M12 4C6.8 4 3 7.7 3 11.8c0 2.5 1.3 4.7 3.3 6.3-.1.8-.5 1.9-1.4 2.9-.25.28-.1.72.27.74 1.63.1 3.24-.37 4.37-.97a11.5 11.5 0 002.46.28c5.2 0 9-3.7 9-7.8C21 7.7 17.2 4 12 4z" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
              <span class="font-medium">Comment</span>
              <span class="ml-1 text-slate-500">${cmCount}</span>
            </button>
            <button class="inline-flex items-center gap-1 text-slate-600 hover:text-slate-800" title="Send" onclick="sendPost('${p.id}')">
              <svg class="w-5 h-5 -rotate-45" viewBox="0 0 24 24" fill="none"><path d="M3.5 4.5l17 7-17 7 4.2-7L3.5 4.5zM7.7 11.5h12.8" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
              <span class="font-medium">Send</span>
            </button>
          </div>
          <button class="inline-flex items-center gap-1 ${p.saved?'text-amber-600':'text-slate-600 hover:text-slate-800'}" onclick="toggleSave('${p.id}')">
            ${p.saved
              ? `<svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M6.32 2.577A1.875 1.875 0 018.003 1.5h7.994c1.035 0 1.875.84 1.875 1.875v17.154a.75.75 0 01-1.2.6L12 16.5l-4.672 4.629a.75.75 0 01-1.2-.6V2.577z"/></svg>`
              : `<svg class="w-5 h-5" viewBox="0 0 24 24" fill="none"><path d="M8 2.5h8c1.1 0 2 .9 2 2v15.7c0 .6-.7 1-1.2.6L12 16.5l-4.8 4.3c-.5 .4-1.2 0-1.2-.6V4.5c0-1.1.9-2 2-2z" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/></svg>`
            }
            <span class="font-medium">${p.saved ? 'Saved' : 'Save'}</span>
          </button>
        </div>
        <div id="cwrap-${p.id}" class="mt-3 hidden">${renderCommentsBlock(p)}</div>
      `;
      const menuBtn = wrap.querySelector('button[aria-label="post menu"]');
      const menu = menuBtn.nextElementSibling;
      menuBtn.addEventListener('click', e => { e.stopPropagation(); menu.classList.toggle('hidden'); });
      document.addEventListener('click', e => { if(!menu.contains(e.target) && !menuBtn.contains(e.target)) menu.classList.add('hidden'); });

      wireReactions(wrap, p);
      return wrap;
    }

    /* ====== COMMENTS ====== */
    const expandedReplies = new Set();
    const openReplyFor    = new Set();

    function renderCommentsBlock(p){
      const list = (p.comments||[]).map(c=>{
        const shown = Math.min(1, c.replies?.length||0);
        const isOpen = expandedReplies.has(c.id);
        const hiddenCount = Math.max(0, (c.replies?.length||0) - shown);
        const repliesToShow = isOpen ? (c.replies||[]) : (c.replies||[]).slice(0, shown);

        const composer = openReplyFor.has(c.id) ? `
          <div class="mt-2 ml-10 flex items-center gap-2">
            <img src="https://i.pravatar.cc/32?img=5" class="h-8 w-8 rounded-full">
            <div class="flex-1 relative">
              <input id="reply-${p.id}-${c.id}" class="w-full rounded-full border border-slate-300 pl-4 pr-24 py-2 bg-white focus:outline-none focus:border-blue-400" placeholder="Write a reply...">
              <button class="absolute right-2 top-1/2 -translate-y-1/2 px-4 py-1.5 rounded-full bg-blue-600 text-white text-sm"
                      onclick="addReply('${p.id}','${c.id}')">Send</button>
            </div>
          </div>` : '';

        return `
          <div class="space-y-2" id="clist-${p.id}-${c.id}">
            ${renderOneComment(p.id,c)}
            ${composer}
            ${repliesToShow.map(r=>renderOneReply(p.id,c.id,r)).join('')}
            ${(hiddenCount>0 && !isOpen) ? `<button class="text-xs text-slate-600 hover:underline ml-10" onclick="expandReplies('${c.id}')">View ${hiddenCount} more repl${hiddenCount>1?'ies':'y'}</button>` : '' }
          </div>`;
      }).join('');

      return `
        <div class="rounded-2xl border bg-white p-3">
          <div class="mb-3 flex items-center gap-2">
            <img src="https://i.pravatar.cc/32?img=5" class="h-8 w-8 rounded-full">
            <div class="flex-1 relative">
              <input id="cinput-${p.id}" class="w-full rounded-full border border-slate-300 pl-4 pr-24 py-2 bg-slate-50 focus:outline-none focus:border-blue-400" placeholder="Add a comment...">
              <button class="absolute right-2 top-1/2 -translate-y-1/2 px-4 py-1.5 rounded-full bg-blue-600 text-white text-sm" onclick="addComment('${p.id}')">Send</button>
            </div>
          </div>

          <div class="mb-2 text-sm text-slate-600">Most relevant</div>
          <div class="space-y-4">
            ${list || '<div class="text-slate-500 text-sm">No comments yet.</div>'}
          </div>
        </div>`;
    }

    function renderOneComment(pid,c){
      const isEditing = editing.type==='comment' && editing.pid===pid && editing.cid===c.id;
      if(isEditing){
        return `
          <div class="flex gap-2">
            <img src="https://i.pravatar.cc/32?img=12" class="h-8 w-8 rounded-full">
            <div class="flex-1">
              <div class="flex items-center gap-2">
                <span class="font-semibold text-sm">${c.author}</span>
                <span class="text-slate-500 text-xs">· 1h</span>
              </div>
              <div class="rounded-2xl bg-white border p-2 mt-1">
                <textarea id="editc-${pid}-${c.id}" rows="2" class="w-full rounded border px-2 py-1">${escapeHTML(c.text)}</textarea>
                <div class="mt-1 flex gap-2 justify-end text-xs">
                  <button class="px-2 py-1 rounded border" onclick="cancelEdit()">Cancel</button>
                  <button class="px-2 py-1 rounded bg-blue-600 text-white" onclick="saveEditComment('${pid}','${c.id}')">Save</button>
                </div>
              </div>
            </div>
          </div>`;
      }
      /* NOTE: no <ul>/<li> — clean cards, no bullets */
      return `
        <div class="flex gap-2">
          <img src="https://i.pravatar.cc/32?img=12" class="h-8 w-8 rounded-full">
          <div class="flex-1">
            <div class="flex items-center gap-2">
              <span class="font-semibold text-sm">${c.author}</span>
              <span class="text-slate-500 text-xs">· 1h</span>
            </div>
            <div class="inline-block max-w-[90%] rounded-2xl bg-slate-50 border px-3 py-2 mt-1">
              <div class="text-sm">${escapeHTML(c.text)}</div>
            </div>
            <div class="mt-1 flex items-center gap-4 text-xs text-slate-600">
              <button class="hover:underline" onclick="likeComment('${pid}','${c.id}')">Like${c.likes?` · ${c.likes}`:''}</button>
              <button class="hover:underline" onclick="toggleReplyComposer('${pid}','${c.id}')">${openReplyFor.has(c.id)?'Cancel':'Reply'}</button>
              <button class="hover:underline" onclick="startEditComment('${pid}','${c.id}')">Edit</button>
              <button class="hover:underline text-red-600" onclick="deleteComment('${pid}','${c.id}')">Delete</button>
            </div>
          </div>
        </div>`;
    }
    function renderOneReply(pid,cid,r){
      const isEditing = editing.type==='reply' && editing.pid===pid && editing.cid===cid && editing.rid===r.id;
      if(isEditing){
        return `
          <div class="flex gap-2 ml-10">
            <img src="https://i.pravatar.cc/32?img=15" class="h-8 w-8 rounded-full">
            <div class="flex-1">
              <div class="flex items-center gap-2">
                <span class="font-semibold text-sm">${r.author}</span>
                <span class="text-slate-500 text-xs">· 30m</span>
              </div>
              <div class="rounded-2xl bg-white border p-2 mt-1">
                <textarea id="editr-${pid}-${cid}-${r.id}" rows="2" class="w-full rounded border px-2 py-1">${escapeHTML(r.text)}</textarea>
                <div class="mt-1 flex gap-2 justify-end text-xs">
                  <button class="px-2 py-1 rounded border" onclick="cancelEdit()">Cancel</button>
                  <button class="px-2 py-1 rounded bg-blue-600 text-white" onclick="saveEditReply('${pid}','${cid}','${r.id}')">Save</button>
                </div>
              </div>
            </div>
          </div>`;
      }
      return `
        <div class="flex gap-2 ml-10">
          <img src="https://i.pravatar.cc/32?img=15" class="h-8 w-8 rounded-full">
          <div class="flex-1">
            <div class="flex items-center gap-2">
              <span class="font-semibold text-sm">${r.author}</span>
              <span class="text-slate-500 text-xs">· 30m</span>
            </div>
            <div class="inline-block max-w-[90%] rounded-2xl bg-white border px-3 py-2 mt-1">
              <div class="text-sm">${escapeHTML(r.text)}</div>
            </div>
            <div class="mt-1 flex items-center gap-4 text-xs text-slate-600">
              <button class="hover:underline" onclick="likeReply('${pid}','${cid}','${r.id}')">Like${r.likes?` · ${r.likes}`:''}</button>
              <button class="hover:underline" onclick="startEditReply('${pid}','${cid}','${r.id}')">Edit</button>
              <button class="hover:underline text-red-600" onclick="deleteReply('${pid}','${cid}','${r.id}')">Delete</button>
            </div>
          </div>
        </div>`;
    }
    function toggleReplyComposer(pid,cid){ if(openReplyFor.has(cid)) openReplyFor.delete(cid); else openReplyFor.add(cid); render(); document.getElementById(`reply-${pid}-${cid}`)?.focus(); }
    function expandReplies(cid){ expandedReplies.add(cid); render(); }
    function toggleSave(id){ const p=state.posts.find(x=>x.id===id); p.saved=!p.saved; render(); toast(p.saved?'Saved':'Removed from saved'); }
    function sendPost(){ toast('Sent'); }
    function toggleComments(id){ document.getElementById('cwrap-'+id).classList.toggle('hidden'); }
    function addComment(id){
      const p=state.posts.find(x=>x.id===id);
      const inp=document.getElementById('cinput-'+id);
      const t=inp.value.trim(); if(!t) return;
      p.comments=p.comments||[];
      p.comments.push({id:'c'+Date.now(), author:'You', text:t, likes:0, replies:[]});
      inp.value=''; render(); document.getElementById('cwrap-'+id).classList.remove('hidden'); toast('Comment posted');
    }
    function addReply(pid,cid){
      const p=state.posts.find(x=>x.id===pid);
      const c=p.comments.find(x=>x.id===cid);
      const inp=document.getElementById(`reply-${pid}-${cid}`);
      const t=inp.value.trim(); if(!t) return;
      (c.replies||(c.replies=[])).push({id:'r'+Date.now(), author:'You', text:t, likes:0});
      openReplyFor.delete(cid); inp.value=''; expandedReplies.add(cid); render(); document.getElementById('cwrap-'+pid).classList.remove('hidden'); toast('Reply added');
    }
    function likeComment(pid,cid){ const p=state.posts.find(x=>x.id===pid); const c=p.comments.find(x=>x.id===cid); c.likes=(c.likes||0)+1; render(); document.getElementById('cwrap-'+pid).classList.remove('hidden'); }
    function likeReply(pid,cid,rid){ const p=state.posts.find(x=>x.id===pid); const c=p.comments.find(x=>x.id===cid); const r=c.replies.find(x=>x.id===rid); r.likes=(r.likes||0)+1; render(); document.getElementById('cwrap-'+pid).classList.remove('hidden'); }
    function startEditComment(pid,cid){ editing={type:'comment',pid,cid,rid:null}; render(); document.getElementById(`editc-${pid}-${cid}`)?.focus(); }
    function saveEditComment(pid,cid){ const p=state.posts.find(x=>x.id===pid); const c=p.comments.find(x=>x.id===cid); const v=document.getElementById(`editc-${pid}-${cid}`).value.trim(); if(v) c.text=v; editing={type:null}; render(); }
    function deleteComment(pid,cid){ const p=state.posts.find(x=>x.id===pid); p.comments=p.comments.filter(c=>c.id!==cid); openReplyFor.delete(cid); editing={type:null}; render(); }
    function startEditReply(pid,cid,rid){ editing={type:'reply',pid,cid,rid}; render(); document.getElementById(`editr-${pid}-${cid}-${rid}`)?.focus(); }
    function saveEditReply(pid,cid,rid){ const p=state.posts.find(x=>x.id===pid); const c=p.comments.find(x=>x.id===cid); const r=c.replies.find(x=>x.id===rid); const v=document.getElementById(`editr-${pid}-${cid}-${rid}`).value.trim(); if(v) r.text=v; editing={type:null}; render(); }
    function deleteReply(pid,cid,rid){ const p=state.posts.find(x=>x.id===pid); const c=p.comments.find(x=>x.id===cid); c.replies=c.replies.filter(r=>r.id!==rid); editing={type:null}; render(); }
    function cancelEdit(){ editing={type:null}; render(); }
    function deletePost(id){ state.posts=state.posts.filter(x=>x.id!==id); render(); }

    /* ====== Skills model (months-based) ====== */
    let skillSort = 'name';
    let skillFilter = '';

    function asSkill(s){
      if(typeof s === 'string'){
        return { name:s, level:70, months:12, endorsements:0, verified:false };
      }
      const months = s.months != null ? Number(s.months)
                    : (s.years != null ? Math.round(Number(s.years)*12) : 12);
      return {
        name: s.name || 'Skill',
        level: Math.max(0, Math.min(100, Number(s.level ?? 70))),
        months: Math.max(0, months||0),
        endorsements: Number(s.endorsements ?? 0),
        verified: !!s.verified
      };
    }
    function normalizeSkills(){ state.skills = (state.skills || []).map(asSkill); }
    function expLabel(months){
      const y=Math.floor(months/12), m=months%12;
      if(y && m) return `${y} yr${y>1?'s':''} ${m} mo`;
      if(y) return `${y} yr${y>1?'s':''}`;
      return `${m} mo`;
    }
    function endorseSkill(idx){
      const s = state.skills[idx]; if(!s) return;
      s.endorsements = (s.endorsements||0) + 1; toast(`Endorsed ${s.name}`); render();
    }
    function setSkillSort(val){ skillSort = val; render(); }
    function setSkillFilter(val){ skillFilter = val.toLowerCase(); render(); }
    function sortSkills(list){
      if(skillSort === 'level') return [...list].sort((a,b)=>b.level-a.level || a.name.localeCompare(b.name));
      if(skillSort === 'endorse') return [...list].sort((a,b)=>b.endorsements-a.endorsements || a.name.localeCompare(b.name));
      return [...list].sort((a,b)=>a.name.localeCompare(b.name));
    }
    function filterSkills(list){ if(!skillFilter) return list; return list.filter(s => s.name.toLowerCase().includes(skillFilter)); }

    /* ====== Edit modal plumbing ====== */
    const modal=document.getElementById('editModal');
    const editTitle=document.getElementById('editTitle');
    const editSlot=document.getElementById('editSlot');
    const editSave=document.getElementById('editSaveBtn');

    function openEdit(kind, payload=null){
      modal.classList.remove('hidden');

      if(kind==='postCaption' && payload){
        const p = state.posts.find(x=>x.id===payload.pid);
        editTitle.textContent='Edit caption';
        editSlot.innerHTML=`<textarea id="capInput" rows="4" class="w-full border rounded px-3 py-2" placeholder="Write a caption...">${escapeHTML(p.caption||'')}</textarea>`;
        editSave.onclick=()=>{ p.caption = document.getElementById('capInput').value.trim(); closeEdit(); render(); };
        return;
      }

      if(kind==='avatar'){
        editTitle.textContent='Edit Profile Photo';
        editSlot.innerHTML=`<input id="avatarInput" class="w-full border rounded px-3 py-2" placeholder="Paste image URL" value="${state.avatar}">`;
        editSave.onclick=()=>{ state.avatar=document.getElementById('avatarInput').value||state.avatar; closeEdit(); render(); toast('Profile photo updated'); };
      }else if(kind==='cover'){
        editTitle.textContent='Edit Cover Photo';
        editSlot.innerHTML=`<input id="coverInput" class="w-full border rounded px-3 py-2" placeholder="Paste image URL" value="${state.cover}">`;
        editSave.onclick=()=>{ state.cover=document.getElementById('coverInput').value||state.cover; closeEdit(); render(); toast('Cover updated'); };
      }else if(kind==='nameUser'){
        editTitle.textContent='Edit Profile Name & Username';
        editSlot.innerHTML=`
          <input id="nameInput" class="w-full border rounded px-3 py-2 mb-2" placeholder="Full name" value="${state.name||''}">
          <input id="userInput" class="w-full border rounded px-3 py-2" placeholder="Username (with @)" value="${state.username||''}">
        `;
        editSave.onclick=()=>{
          state.name=document.getElementById('nameInput').value||state.name;
          state.username=document.getElementById('userInput').value||state.username;
          closeEdit(); render(); toast('Profile updated');
        };
      }
    }
    function closeEdit(){ modal.classList.add('hidden'); }

    /* ====== Structured editors ====== */

    // Skills Editor (wider & scrollable)
    function openSkillEditor() {
      normalizeSkills();
      modal.classList.remove('hidden');
      editTitle.textContent = 'Edit Skills';

      const head = `
        <div class="editor-head px-2 py-2">
          <div class="editor-grid text-xs font-semibold text-slate-600">
            <div>Skill</div>
            <div>Proficiency (%)</div>
            <div>Experience</div>
            <div>Unit</div>
            <div>Verified</div>
            <div>Actions</div>
          </div>
        </div>
      `;

      const rows = state.skills.map((s, i) => `
        <div class="editor-row p-2 rounded-lg border bg-white">
          <input class="border rounded px-2 py-1" value="${escapeHTML(s.name)}" data-k="name" data-i="${i}">
          <input class="border rounded px-2 py-1" type="number" min="0" max="100" value="${s.level}" data-k="level" data-i="${i}">
          <input class="border rounded px-2 py-1" type="number" min="0" max="600" value="${s.months}" data-k="months" data-i="${i}">
          <select class="border rounded px-2 py-1" data-k="unit" data-i="${i}">
            <option value="months" selected>months</option>
            <option value="years">years</option>
          </select>
          <label class="inline-flex items-center gap-2 text-sm">
            <input type="checkbox" ${s.verified?'checked':''} data-k="verified" data-i="${i}"> Verified
          </label>
          <div class="text-right">
            <button class="px-2 py-1 rounded bg-red-50 text-red-600 text-sm"
                    onclick="deleteItem('skills', ${i})">Remove</button>
          </div>
        </div>
      `).join('');

      editSlot.innerHTML = `
        ${head}
        <div class="space-y-2">${rows || '<div class="text-slate-500 text-sm">No skills yet.</div>'}</div>
        <div class="pt-2">
          <button class="px-3 py-2 rounded-lg border" onclick="addNewSkill()">+ Add Skill</button>
        </div>
      `;

      editSave.onclick = () => {
        const inputs = editSlot.querySelectorAll('[data-i]');
        const next = [...state.skills];
        inputs.forEach(el=>{
          const i = Number(el.dataset.i), k = el.dataset.k;
          if(next[i] == null) return;
          if(k === 'name') next[i].name = el.value.trim();
          if(k === 'level') next[i].level = Math.max(0, Math.min(100, Number(el.value)));
          if(k === 'months') next[i].months = Math.max(0, Number(el.value));
          if(k === 'unit'){
            if(el.value === 'years'){
              const monthsInput = editSlot.querySelector(`input[data-k="months"][data-i="${i}"]`);
              if(monthsInput){ next[i].months = Math.round(Number(monthsInput.value || 0) * 12); }
            }
          }
          if(k === 'verified') next[i].verified = el.checked;
        });
        state.skills = next.map(asSkill);
        closeEdit(); render(); toast('Skills updated');
      };
    }
    function addNewSkill(){
      state.skills.push({name:'New Skill', level:50, months:12, endorsements:0, verified:false});
      openSkillEditor();
    }

    // Universal list editor for Bio/Edu/Exp/Contact (no bullets)
    function openListEditor(key, label, placeholder='Type item…') {
      modal.classList.remove('hidden');
      editTitle.textContent = `Edit ${label}`;

      const list = Array.isArray(state[key]) ? state[key] : [];
      const rows = list.map((val, i) => `
        <div class="grid grid-cols-12 gap-2 items-center p-2 rounded-lg border">
          <input class="col-span-10 border rounded px-3 py-2" value="${escapeHTML(val)}" data-i="${i}">
          <button class="col-span-2 px-2 py-2 rounded bg-red-50 text-red-600 text-sm"
                  onclick="deleteItem('${key}', ${i})">Remove</button>
        </div>
      `).join('');

      editSlot.innerHTML = `
        <div class="editor-head px-2 py-2">
          <div class="text-xs font-semibold text-slate-600">Item</div>
        </div>
        <div class="space-y-2">${rows || '<div class="text-slate-500 text-sm">No items yet.</div>'}</div>
        <div class="grid grid-cols-12 gap-2 items-center mt-2">
          <input id="newRow" class="col-span-10 border rounded px-3 py-2" placeholder="${placeholder}">
          <button class="col-span-2 px-3 py-2 rounded-lg border" onclick="addRowToList('${key}')">+ Add</button>
        </div>
      `;
      editSave.onclick = () => {
        const inputs = editSlot.querySelectorAll('input[data-i]');
        const next = [];
        inputs.forEach(el => { const v = el.value.trim(); if(v) next.push(v); });
        state[key] = next;
        closeEdit(); render(); toast(label+' updated');
      };
    }
    function addRowToList(key){
      const inp = document.getElementById('newRow');
      const v = (inp.value||'').trim();
      if(!v) return;
      (state[key]||(state[key]=[])).push(v);
      openListEditor(key, key.charAt(0).toUpperCase()+key.slice(1));
    }

    /* ---------- Big feed ---------- */
    function buildPosts(){
      let id=1, posts=[];
      const avatar='https://i.pravatar.cc/40?img=5';
      const add = p => { p.id='p'+(id++); p.author='Sakshi'; p.avatar=avatar; p.saved=false; p.reaction=null; p.comments=[]; posts.push(p); };

      const singles=[
        'https://images.unsplash.com/photo-1587614382346-4ec70e388b28?auto=format&fit=crop&w=1600&q=80',
        'https://images.unsplash.com/photo-1557800636-894a64c1696f?auto=format&fit=crop&w=1600&q=80',
        'https://images.unsplash.com/photo-1503676260728-1c00da094a0b?auto=format&fit=crop&w=1600&q=80',
        'https://images.unsplash.com/photo-1513258496099-48168024aec0?auto=format&fit=crop&w=1600&q=80',
        'https://images.unsplash.com/photo-1519389950473-47ba0277781c?auto=format&fit=crop&w=1600&q=80',
        'https://images.unsplash.com/photo-1531482615713-2afd69097998?auto=format&fit=crop&w=1600&q=80',
        'https://images.unsplash.com/photo-1555529771-35a38fb89a54?auto=format&fit=crop&w=1600&q=80',
        'https://images.unsplash.com/photo-1554774853-b415df9eeb92?auto=format&fit=crop&w=1600&q=80',
        'https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=1600&q=80',
        'https://images.unsplash.com/photo-1523246206020-0826f8f1a7bf?auto=format&fit=crop&w=1600&q=80',
        'https://images.unsplash.com/photo-1542744173-8e7e53415bb0?auto=format&fit=crop&w=1600&q=80',
        'https://images.unsplash.com/photo-1520975922203-b4a49b37e471?auto=format&fit=crop&w=1600&q=80'
      ];
      const g2 = [
        ['https://images.unsplash.com/photo-1522071820081-009f0129c71c?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1520975922203-b4a49b37e471?auto=format&fit=crop&w=1200&q=80'],
        ['https://images.unsplash.com/photo-1522202176988-66273c2fd55f?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=1200&q=80'],
        ['https://images.unsplash.com/photo-1532012197267-da84d127e765?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1542744173-8e7e53415bb0?auto=format&fit=crop&w=1200&q=80'],
        ['https://images.unsplash.com/photo-1551836022-d5d88e9218df?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1519389950473-47ba0277781c?auto=format&fit=crop&w=1200&q=80'],
        ['https://images.unsplash.com/photo-1523246206020-0826f8f1a7bf?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1516574187841-cb9cc2ca948b?auto=format&fit=crop&w=1200&q=80']
      ];
      const g3 = [
        ['https://images.unsplash.com/photo-1519389950473-47ba0277781c?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1551836022-d5d88e9218df?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1531482615713-2afd69097998?auto=format&fit=crop&w=1200&q=80'],
        ['https://images.unsplash.com/photo-1543269864-76bc3997d9ea?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1523246206020-0826f8f1a7bf?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1516574187841-cb9cc2ca948b?auto=format&fit=crop&w=1200&q=80'],
        ['https://images.unsplash.com/photo-1532012197267-da84d127e765?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1522202176988-66273c2fd55f?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1555529771-35a38fb89a54?auto=format&fit=crop&w=1200&q=80']
      ];
      const g4 = [
        ['https://images.unsplash.com/photo-1502720705749-3cfa7b0c8f47?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1496307042754-b4aa456c4a2d?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1518085250887-2f903c200fee?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1518085250887-2f903c200fee?auto=format&fit=crop&w=1200&q=80'],
        ['https://images.unsplash.com/photo-1532012197267-da84d127e765?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1522202176988-66273c2fd55f?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1555529771-35a38fb89a54?auto=format&fit=crop&w=1200&q=80']
      ];
      const g5 = [
        ['https://images.unsplash.com/photo-1519389950473-47ba0277781c?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1551836022-d5d88e9218df?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1531482615713-2afd69097998?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1555529771-35a38fb89a54?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1543269864-76bc3997d9ea?auto=format&fit=crop&w=1200&q=80'],
        ['https://images.unsplash.com/photo-1503676260728-1c00da094a0b?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1513258496099-48168024aec0?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1516574187841-cb9cc2ca948b?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1523246206020-0826f8f1a7bf?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1554774853-b415df9eeb92?auto=format&fit=crop&w=1200&q=80','https://images.unsplash.com/photo-1542744173-8e7e53415bb0?auto=format&fit=crop&w=1200&q=80']
      ];
      const vids=[
        'https://samplelib.com/lib/preview/mp4/sample-5s.mp4',
        'https://samplelib.com/lib/preview/mp4/sample-10s.mp4',
        'https://samplelib.com/lib/preview/mp4/sample-15s.mp4',
        'https://samplelib.com/lib/preview/mp4/sample-20s.mp4',
        'https://samplelib.com/lib/preview/mp4/sample-30s.mp4'
      ];

      add({type:'text', time:'1h', caption:'Cleared the Agile PM certification today 🎓', text:'Exam tips: timebox every section; flag and move; return for the last 10 minutes.', likes:18});
      add({type:'text', time:'3h', caption:'Offer update', text:'Got a call for the SDE-1 role—system design round next week!', likes:25});

      for(let i=0;i<FEED_SIZE;i++){
        const t = i % 6;
        if(t===0){
          const src = singles[i % singles.length];
          add({type:'image', time:`${(i%10)+2}h`, caption:'Mock interview—DSA round today.', src, likes:10+(i%30)});
        }else if(t===1){
          const images = g2[i % g2.length];
          add({type:'gallery', time:`${(i%10)+3}h`, caption:'Leetcode grind + whiteboard review.', images, likes:15+(i%30)});
        }else if(t===2){
          const images = g3[i % g3.length];
          add({type:'gallery', time:`${(i%10)+4}h`, caption:'Team sprint review snapshots.', images, likes:12+(i%30)});
        }else if(t===3){
          const images = g4[i % g4.length];
          add({type:'gallery', time:`${(i%10)+6}h`, caption:'Campus fest + project demo.', images, likes:14+(i%30)});
        }else if(t===4){
          const images = g5[i % g5.length];
          add({type:'gallery', time:`${(i%10)+8}h`, caption:'Hackathon day in pictures.', images, likes:18+(i%30)});
        }else{
          const src = vids[i % vids.length];
          add({type:'video', time:`${(i%7)+1}d`, caption:'Demo clip: portfolio / dashboard / case study.', src, likes:8+(i%20)});
        }
      }

      add({type:'image', time:'2d', caption:'Daily notes from system design.', src:'https://images.unsplash.com/photo-1519389950473-47ba0277781c?auto=format&fit=crop&w=1600&q=80', likes:31});
      add({type:'gallery', time:'3d', caption:'Placement drive highlights.', images:[
        'https://images.unsplash.com/photo-1522202176988-66273c2fd55f?auto=format&fit=crop&w=1200&q=80',
        'https://images.unsplash.com/photo-1532012197267-da84d127e765?auto=format&fit=crop&w=1200&q=80',
        'https://images.unsplash.com/photo-1542744173-8e7e53415bb0?auto=format&fit=crop&w=1200&q=80',
        'https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=1200&q=80',
        'https://images.unsplash.com/photo-1555529771-35a38fb89a54?auto=format&fit=crop&w=1200&q=80'
      ], likes:28});

      return posts;
    }

    /* toolbar hooks for tabs */
    btnAdd.addEventListener('click', () => {
      if(currentTab==='skill'){ addNewSkill(); return; }
      if(currentTab==='bio') openListEditor('bio','Bio','Write a short line…');
      else if(currentTab==='edu') openListEditor('education','Education','Degree, School, Years…');
      else if(currentTab==='exp') openListEditor('experience','Experience','Role @ Company (Years)…');
      else if(currentTab==='contact') openListEditor('contact','Contact','Label: value');
    });
    btnEdit.addEventListener('click', () => {
      if(currentTab==='skill'){ openSkillEditor(); return; }
      if(currentTab==='bio') openListEditor('bio','Bio','Write a short line…');
      else if(currentTab==='edu') openListEditor('education','Education','Degree, School, Years…');
      else if(currentTab==='exp') openListEditor('experience','Experience','Role @ Company (Years)…');
      else if(currentTab==='contact') openListEditor('contact','Contact','Label: value');
    });
    btnDelete.addEventListener('click', () => {
      const nextKey = currentTab==='skill' ? 'skills'
                     : currentTab==='bio' ? 'bio'
                     : currentTab==='edu' ? 'education'
                     : currentTab==='exp' ? 'experience'
                     : currentTab==='contact' ? 'contact' : null;
      deleteModeKey = (deleteModeKey===nextKey) ? null : nextKey;
      render();
      toast(deleteModeKey ? 'Delete mode: tap trash icons' : 'Delete mode off');
    });

    /* contact helpers */
    function detectContact(item){
      const s=item.trim();
      const emailMatch = s.match(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}/i);
      const phoneMatch = s.match(/(\+?\d[\d\s\-]{6,}\d)/);
      const urlMatch = s.match(/(https?:\/\/[^\s]+)/i);
      if(emailMatch) return {type:'email', label:s, href:`mailto:${emailMatch[0]}`};
      if(phoneMatch) return {type:'phone', label:s, href:`tel:${phoneMatch[0].replace(/\s|-/g,'')}`};
      if(urlMatch) return {type:'link', label:s, href:urlMatch[0]};
      return {type:'text', label:s, href:null};
    }
    function contactIcon(t){
      if(t==='email') return `<svg class="w-4 h-4 text-blue-600" viewBox="0 0 24 24" fill="currentColor"><path d="M2 6a2 2 0 012-2h16a2 2 0 012 2v.4l-10 6.25L2 6.4V6z"/><path d="M2 8.2l10 6.25L22 8.2V18a2 2 0 01-2 2H4a2 2 0 01-2-2V8.2z"/></svg>`;
      if(t==='phone') return `<svg class="w-4 h-4 text-emerald-600" viewBox="0 0 24 24" fill="currentColor"><path d="M3 5a2 2 0 012-2h2a1 1 0 011 .8l1 4a1 1 0 01-.3 1L7.9 11a13 13 0 006.2 6.2l2.2-1.8a1 1 0 011-.2l4 1a1 1 0 01.7 1V20a2 2 0 01-2 2h-1C9.16 22 2 14.84 2 6V5z"/></svg>`;
      if(t==='link')  return `<svg class="w-4 h-4 text-indigo-600" viewBox="0 0 24 24" fill="currentColor"><path d="M10.6 13.4a4 4 0 005.7 0l2.3-2.3a4 4 0 10-5.7-5.7l-1 1"/><path d="M13.4 10.6a4 4 0 00-5.7 0l-2.3 2.3a4 4 0 105.7 5.7l1-1"/></svg>`;
      return `<svg class="w-4 h-4 text-slate-600" viewBox="0 0 24 24" fill="currentColor"><circle cx="12" cy="12" r="3"/></svg>`;
    }

    /* ---------- RENDER ---------- */
    function render(){
      document.getElementById('profileName').textContent=state.name;
      document.getElementById('profileUser').textContent=state.username;
      document.getElementById('avatarImg').src=state.avatar;
      document.getElementById('coverImg').src=state.cover;

      const trashBtn=(key,idx)=> deleteModeKey===key
        ? `<button onclick="deleteItem('${key}',${idx})" class="p-1 hover:bg-red-100 rounded text-red-600" title="Delete">
             <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M9 3a1 1 0 00-1 1v1H5.5a1 1 0 100 2H6v12a2 2 0 002 2h8a2 2 0 002-2V7h.5a1 1 0 100-2H16V4a1 1 0 00-1-1H9zm2 3V4h4v2h-4zM9 9a1 1 0 012 0v8a1 1 0 11-2 0V9zm6 0a1 1 0 10-2 0v8a1 1 0 102 0V9z"/></svg>
           </button>` : '';

      /* Bio */
      document.getElementById('content-bio').innerHTML =
        (state.bio&&state.bio.length)
          ? state.bio.map((x,i)=>`
              <div class="p-3 rounded-xl border bg-gradient-to-br from-slate-50 to-white flex justify-between items-center">
                <span class="inline-flex items-start gap-2"><span class="mt-1 text-blue-600">❝</span><span>${escapeHTML(x)}</span></span>
                ${trashBtn('bio',i)}
              </div>`).join('')
          : `<div class="p-3 rounded-xl border bg-slate-50 text-slate-500">No bio items yet.</div>`;

      /* Education — clean cards, no bullets */
      document.getElementById('content-edu').innerHTML =
        (state.education||[]).map((x,i)=>`
          <div class="p-3 rounded-xl border bg-white flex justify-between items-start">
            <div class="flex items-start gap-3">
              <span class="inline-grid place-items-center h-8 w-8 rounded-xl bg-indigo-50 ring-1 ring-indigo-100 text-indigo-600">🎓</span>
              <div>
                <div class="font-medium">${escapeHTML(x)}</div>
                <div class="text-xs text-slate-500">Education</div>
              </div>
            </div>
            ${trashBtn('education',i)}
          </div>`).join('') || `<div class="p-3 rounded-xl border bg-slate-50 text-slate-500">No education added.</div>`;

      /* Skills */
      normalizeSkills();

      const skillsToolbar = `
        <div class="mb-2 flex flex-wrap items-center gap-2 text-xs">
          <input id="skillSearch" class="rounded-lg border border-slate-300 bg-white px-3 py-1.5"
                 placeholder="Search skills…" value="${escapeHTML(skillFilter)}" />
          <select id="skillSort" class="rounded-lg border border-slate-300 bg-white px-2 py-1.5">
            <option value="name" ${skillSort==='name'?'selected':''}>Sort: Name (A–Z)</option>
            <option value="level" ${skillSort==='level'?'selected':''}>Sort: Level (High→Low)</option>
            <option value="endorse" ${skillSort==='endorse'?'selected':''}>Sort: Endorsements</option>
          </select>
        </div>
      `;

      const prettySkill = (s, idx) => `
        <div class="p-3 rounded-xl border bg-white flex justify-between items-center">
          <div class="flex items-center gap-3">
            ${skillIcon(s.name)}
            <div>
              <div class="font-medium text-[15px] flex items-center gap-2">
                ${escapeHTML(s.name)}
                ${s.verified ? `<span class="badge-verified">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
                      <path d="M12 2l2.3 2.1 3.2-.2 1.3 2.9 2.8 1-1 3 1 3-2.8 1-1.3 2.9-3.2-.2L12 22l-2.3-2.1-3.2.2L5.2 17 2.4 16l1-3-1-3 2.8-1 1.3-2.9 3.2.2L12 2z" fill="#3b82f6" opacity=".18"/>
                      <path d="M9.2 12l2 2 4-4" stroke="#2563eb" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg> Verified
                  </span>`:''}
                <span class="text-slate-500 text-xs">• ${expLabel(s.months)} exp</span>
              </div>
              <div class="mt-2 w-48 skill-meter"><span style="width:${s.level}%;"></span></div>
              <div class="mt-1 text-xs text-slate-500">${s.level}% proficiency • ${s.endorsements||0} endorsement${(s.endorsements||0)===1?'':'s'}</div>
            </div>
          </div>

          <div class="flex items-center gap-2">
            <button class="px-2.5 py-1.5 rounded-lg border border-slate-200 hover:bg-slate-50 text-xs"
                    onclick="endorseSkill(${idx})">
              👍 Endorse
            </button>
            ${trashBtn('skills', idx)}
          </div>
        </div>
      `;

      const filteredSorted = sortSkills(filterSkills(state.skills));
      document.getElementById('content-skill').innerHTML =
        skillsToolbar +
        (filteredSorted.length
           ? filteredSorted.map(s => prettySkill(s, state.skills.indexOf(s))).join('')
           : `<div class="p-3 rounded-xl border bg-slate-50 text-slate-500">No matching skills.</div>`);

      // wire toolbar
      document.getElementById('skillSort')?.addEventListener('change', e => setSkillSort(e.target.value));
      document.getElementById('skillSearch')?.addEventListener('input', e => setSkillFilter(e.target.value));

      /* Experience — clean cards, no bullets */
      document.getElementById('content-exp').innerHTML =
        (state.experience||[]).map((x,i)=>`
          <div class="p-3 rounded-xl border bg-white flex justify-between items-start">
            <div class="flex items-start gap-3">
              <span class="inline-grid place-items-center h-8 w-8 rounded-xl bg-emerald-50 ring-1 ring-emerald-100 text-emerald-600">💼</span>
              <div>
                <div class="font-medium">${escapeHTML(x)}</div>
                <div class="text-xs text-slate-500">Experience</div>
              </div>
            </div>
            ${trashBtn('experience',i)}
          </div>`).join('') || `<div class="p-3 rounded-xl border bg-slate-50 text-slate-500">No experience added.</div>`;

      /* Contact */
      document.getElementById('content-contact').innerHTML =
        (state.contact||[]).map((x,i)=>{
          const c = detectContact(x);
          const label = c.href ? `<a href="${c.href}" class="hover:underline" target="_blank" rel="noopener">${escapeHTML(c.label)}</a>` : escapeHTML(c.label);
          return `
          <div class="p-3 rounded-xl border bg-white flex justify-between items-center">
            <span class="inline-flex items-center gap-2">${contactIcon(c.type)} <span>${label}</span></span>
            ${trashBtn('contact',i)}
          </div>`;
        }).join('');

      feedEl.innerHTML=''; state.posts.forEach(p=>feedEl.appendChild(renderPost(p)));
    }

    /* ---------- Build & boot ---------- */
    function init(){
      normalizeSkills();
      state.posts = buildPosts();
      render();
      toggleTab('bio');
    }
    init();

    /* open skills editor from anywhere if needed */
    window.openSkillEditor = openSkillEditor;
  </script>
</body>
</html>
